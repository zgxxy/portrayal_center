(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07f6b8f0"],{"0bd4":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"header"},[r("el-button",{staticStyle:{"margin-top":"4px"},attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("+ 新增")]),r("div",{staticStyle:{float:"right","margin-top":"4px"}},[r("el-button",{attrs:{id:"search",type:"primary"},on:{click:function(t){return e.batchChange(1)}}},[e._v("批量启用")]),r("el-button",{attrs:{id:"search",type:"primary"},on:{click:function(t){return e.batchChange(0)}}},[e._v("批量停用")])],1),r("el-form",{staticClass:"demo-form-inline",staticStyle:{float:"right",transform:"translateX(-10%)"},attrs:{inline:!0,model:e.search}},[r("el-form-item",{attrs:{label:"账号名称："}},[r("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:e.search.username,callback:function(t){e.$set(e.search,"username",t)},expression:"search.username"}})],1),r("el-form-item",{attrs:{label:"状态："}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"small"},model:{value:e.search.state,callback:function(t){e.$set(e.search,"state",t)},expression:"search.state"}},[r("el-option",{attrs:{label:"使用中",value:"1"}}),r("el-option",{attrs:{label:"已停用",value:"0"}})],1)],1),r("el-form-item",[r("el-button",{attrs:{id:"search",type:"primary"},on:{click:function(t){return e.searchClick()}}},[e._v("查询")])],1)],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"",align:"center",data:e.users,"header-cell-style":{textAlign:"center"}},on:{select:e.tableSelect,"select-all":e.tableSelect}},[r("el-table-column",{attrs:{type:"selection",width:"45"}}),r("el-table-column",{attrs:{prop:"userName",label:"账号名称"}}),r("el-table-column",{attrs:{prop:"roleName",label:"权限"}}),r("el-table-column",{attrs:{prop:"userUse",label:"使用人"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),r("el-table-column",{attrs:{prop:"phone",label:"电话"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(" "+e._s(e._f("phoneHide")(t.row.phone))+" ")])]}}])}),r("el-table-column",{attrs:{prop:"state",label:"使用状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{style:1===t.row.state?"color:#409eff":"color:#ea1b29"},[e._v(" "+e._s(1===t.row.state?"使用中":"已停用")+" ")])]}}])}),r("el-table-column",{attrs:{prop:"loginTime",label:"最近登录时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.loginTime?t.row.loginTime.split(".")[0].split("T").join(" "):"")+" ")]}}])}),r("el-table-column",{attrs:{label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!==t.row.state?r("el-button",{staticClass:"btn",attrs:{loading:t.row.loading,size:"mini"},on:{click:function(r){return e.handleChange(1,t.$index,t.row)}}},[e._v("启用")]):e._e(),1===t.row.state?r("el-button",{staticClass:"btn",attrs:{loading:t.row.loading,size:"mini"},on:{click:function(r){return e.handleChange(0,t.$index,t.row)}}},[e._v("停用")]):e._e(),1===t.row.state?r("el-button",{staticClass:"btn",attrs:{loading:t.row.loading,size:"mini"},on:{click:function(r){return e.handlePermission(t.$index,t.row)}}},[e._v("编辑权限")]):e._e(),1===t.row.state?r("el-button",{staticClass:"btn",attrs:{loading:t.row.loading,size:"mini"},on:{click:function(r){return e.passwordReset(t.$index,t.row)}}},[e._v("重置密码")]):e._e(),0===t.row.state?r("el-button",{staticClass:"btn",attrs:{type:"danger",loading:t.row.loading,size:"mini"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])})],1),r("el-dialog",{attrs:{title:"权限编辑",visible:e.PermissionDialogVisible,"close-on-click-modal":!1,width:"30%","before-close":e.permissionClose},on:{"update:visible":function(t){e.PermissionDialogVisible=t}}},[r("el-form",{ref:"PermissionForm",attrs:{model:e.PermissionForm,size:"small","label-width":"100px"}},[r("el-form-item",{attrs:{label:e.PermissionUser,prop:"roleId",rules:{required:!0,message:"请选择权限",trigger:"change"}}},[r("el-radio-group",{model:{value:e.PermissionForm.roleId,callback:function(t){e.$set(e.PermissionForm,"roleId",t)},expression:"PermissionForm.roleId"}},[r("el-radio-button",{attrs:{label:1}},[e._v("管理员")]),r("el-radio-button",{attrs:{label:2}},[e._v("普通用户")])],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.permissionClose()}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.PermissionOk()}}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"新增用户",visible:e.addDialogVisible,"close-on-click-modal":!1,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.addDialogVisible=t}}},[e.errorMessage?r("div",{staticClass:"error"},[r("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#f1473b"}}),e._v(" "+e._s(e.errorMessage)+" ")]):e._e(),r("el-form",{ref:"addForm",attrs:{model:e.addForm,size:"small","label-width":"100px"}},[r("el-form-item",{attrs:{label:"邮箱",prop:"email",rules:{required:!0,validator:e.validateEmail,trigger:"blur"}}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email","string"===typeof t?t.trim():t)},expression:"addForm.email"}})],1),r("el-form-item",{attrs:{label:"账号名称",prop:"username",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username","string"===typeof t?t.trim():t)},expression:"addForm.username"}})],1),r("el-form-item",{attrs:{label:"初始密码",prop:"password",rules:{required:!0,validator:e.validatePassword,trigger:"blur"}}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password","string"===typeof t?t.trim():t)},expression:"addForm.password"}})],1),r("el-form-item",{attrs:{label:"使用人",prop:"userUse",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.userUse,callback:function(t){e.$set(e.addForm,"userUse","string"===typeof t?t.trim():t)},expression:"addForm.userUse"}})],1),r("el-form-item",{attrs:{label:"电话",prop:"phone",rules:{required:!0,validator:e.validatePhone,trigger:"blur"}}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone","string"===typeof t?t.trim():t)},expression:"addForm.phone"}})],1),r("el-form-item",{attrs:{label:"权限",prop:"roleId",rules:{required:!0,message:"请选择权限",trigger:"change"}}},[r("el-radio-group",{model:{value:e.addForm.roleId,callback:function(t){e.$set(e.addForm,"roleId",t)},expression:"addForm.roleId"}},[r("el-radio-button",{attrs:{label:1}},[e._v("管理员")]),r("el-radio-button",{attrs:{label:2}},[e._v("普通用户")])],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.AddOk()}}},[e._v("确 定")])],1)],1),r("div",{staticClass:"block"},[r("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},n=[],i=r("1da1"),s=(r("96cf"),r("ac1f"),r("1276"),r("a434"),r("a15b"),r("d81d"),r("841c"),r("d3b7"),r("99af"),r("3ca3"),r("ddb0"),r("00b4"),r("5723")),o={filters:{phoneHide:function(e){return e=e.split(""),e.splice(3,4,"****"),e.join("")}},data:function(){return{search:{username:"",state:"",isSearched:!1},tableSelectData:[],users:[],page:{pageNo:1,pageSize:10},total:0,currentPage:1,PermissionUserId:"",PermissionUser:"",PermissionDialogVisible:!1,PermissionForm:{roleId:0},addDialogVisible:!1,errorMessage:"",addForm:{email:"",roleId:"",phone:"",password:"",userUse:"",username:""}}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.init({});case 1:case"end":return t.stop()}}),t)})))()},methods:{init:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(s["d"])(t.page,e);case 2:a=r.sent,n=a.records,i=a.total,t.total=i,n.map((function(e){e.loading=!1})),t.users=n;case 8:case"end":return r.stop()}}),r)})))()},searchClick:function(){this.search.isSearched=!0,this.init(this.search)},handleChange:function(e,t,r){var a=this;r.loading=!0,Object(s["c"])({userId:r.userId,state:e}).then((function(){r.loading=!1,a.search.isSearched?a.init(a.search):a.init({})})).catch((function(){r.loading=!1}))},passwordReset:function(e,t){var r=this;t.loading=!0,Object(s["c"])({userId:t.userId,password:12345678}).then((function(){t.loading=!1,r.$message({type:"success",message:"密码重置为12345678"}),r.search.isSearched?r.init(r.search):r.init({})})).catch((function(){t.loading=!1}))},handleDelete:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r.$confirm("是否确认删除用户 ".concat(t.userName),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",lockScroll:!1}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["b"])(t.userId);case 2:r.search.isSearched?r.init(r.search):r.init({}),r.$message({type:"success",message:"删除成功"});case 4:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e)})),console.log(t.userId);case 2:case"end":return e.stop()}}),e)})))()},handlePermission:function(e,t){this.PermissionForm.roleId=t.roleId,this.PermissionUserId=t.userId,this.PermissionUser=t.userName,this.PermissionDialogVisible=!0},PermissionOk:function(){var e=this;Object(s["c"])({userId:this.PermissionUserId,roleId:this.PermissionForm.roleId}).then((function(){e.$message({type:"success",message:"权限修改成功,下次登录生效"}),e.search.isSearched?e.init(e.search):e.init({})})).catch((function(){})),this.permissionClose()},AddOk:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=!0,e.$refs.addForm.validate((function(t){t||(e.errorMessage="表单未完成",r=!1)})),!r){t.next=9;break}return t.next=5,Object(s["a"])(e.addForm);case 5:a=t.sent,console.log(a),e.init({}),e.handleClose();case 9:case"end":return t.stop()}}),t)})))()},tableSelect:function(e,t){this.tableSelectData=e},batchChange:function(e){var t=this,r=1===e?"启用":"停用";if(this.tableSelectData.length){var a=this.tableSelectData.every((function(t){return t.state===e}));a?this.$message.error("所选用户状态均为".concat(r)):this.$confirm("是否".concat(r,"所选的").concat(this.tableSelectData.length,"个用户"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",lockScroll:!1}).then(Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:Promise.all(t.batchChange1(e)).then((function(){t.search.isSearched?t.init(t.search):t.init({}),t.tableSelectData=[],t.$message({type:"success",message:"批量操作成功"})})).catch((function(e){t.$message.error("批量操作失败,".concat(e))}));case 1:case"end":return r.stop()}}),r)})))).catch((function(e){console.log(e)}))}else this.$message.error("尚未选择用户,请勾选左侧选择框")},batchChange1:function(e){var t=this.tableSelectData.map((function(t){if(t.state!==e)return new Promise((function(r,a){Object(s["c"])({userId:t.userId,state:e}).then((function(e){r(e)})).catch((function(e){a(e)}))}))}));return t},handleClose:function(){this.errorMessage="",this.addDialogVisible=!1,this.$refs.addForm.resetFields()},permissionClose:function(){this.PermissionDialogVisible=!1,this.$refs.PermissionForm.resetFields()},handleSizeChange:function(e){this.page.pageNo=1,this.page.pageSize=e,this.init(this.search)},handleCurrentChange:function(e){this.page.pageNo=e,this.init(this.search)},validateEmail:function(e,t,r){""===t&&r(new Error("请输入邮箱地址")),/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(t)?r():r(new Error("输入格式有误"))},validatePassword:function(e,t,r){t.length<6?r(new Error("密码不能小于6位")):r()},validatePhone:function(e,t,r){""===t&&r(new Error("请输入手机号")),/^1[3-9]\d{9}$/.test(t)?r():r(new Error("输入格式有误"))}}},l=o,c=(r("aed6"),r("2877")),u=Object(c["a"])(l,a,n,!1,null,"6990eaf4",null);t["default"]=u.exports},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},2211:function(e,t,r){},"841c":function(e,t,r){"use strict";var a=r("d784"),n=r("825a"),i=r("1d80"),s=r("129f"),o=r("14c3");a("search",1,(function(e,t,r){return[function(t){var r=i(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,r):new RegExp(t)[e](String(r))},function(e){var a=r(t,e,this);if(a.done)return a.value;var i=n(e),l=String(this),c=i.lastIndex;s(c,0)||(i.lastIndex=0);var u=o(i,l);return s(i.lastIndex,c)||(i.lastIndex=c),null===u?-1:u.index}]}))},a15b:function(e,t,r){"use strict";var a=r("23e7"),n=r("44ad"),i=r("fc6a"),s=r("a640"),o=[].join,l=n!=Object,c=s("join",",");a({target:"Array",proto:!0,forced:l||!c},{join:function(e){return o.call(i(this),void 0===e?",":e)}})},a434:function(e,t,r){"use strict";var a=r("23e7"),n=r("23cb"),i=r("a691"),s=r("50c4"),o=r("7b0b"),l=r("65f0"),c=r("8418"),u=r("1dde"),d=r("ae40"),m=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,f=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m||!h},{splice:function(e,t){var r,a,u,d,m,h,v=o(this),w=s(v.length),k=n(e,w),x=arguments.length;if(0===x?r=a=0:1===x?(r=0,a=w-k):(r=x-2,a=f(p(i(t),0),w-k)),w+r-a>g)throw TypeError(b);for(u=l(v,a),d=0;d<a;d++)m=k+d,m in v&&c(u,d,v[m]);if(u.length=a,r<a){for(d=k;d<w-a;d++)m=d+a,h=d+r,m in v?v[h]=v[m]:delete v[h];for(d=w;d>w-a+r;d--)delete v[d-1]}else if(r>a)for(d=w-a;d>k;d--)m=d+a-1,h=d+r-1,m in v?v[h]=v[m]:delete v[h];for(d=0;d<r;d++)v[d+k]=arguments[d+2];return v.length=w-a+r,u}})},aed6:function(e,t,r){"use strict";r("2211")}}]);